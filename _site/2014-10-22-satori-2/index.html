<!DOCTYPE html>
<html lang="en">

<head>
    <title>Satori #2</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="blog, vumanhcuong, mido, jekyll">
    <meta name="author" content="vumanhcuong">
    
    
    

    <meta name="description" content="A minimal jekyll theme">
    <link href='https://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="icon" type="image/ico" href="http://localhost:4000/assets/favicon.ico">
    <link rel="shortcut-icon" type="image/ico" href="http://localhost:4000/assets/favicon.ico">

    <!-- For Facebook -->
    <meta property="og:title" content="Satori #2" />
    <meta property="og:image" content="http://localhost:4000/assets/favicon.ico" />
    <meta property="og:description" content="A minimal jekyll theme" />

    <!-- For Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Satori #2" />
    <meta name="twitter:description" content="A minimal jekyll theme" />
    <meta name="twitter:image" content="http://localhost:4000/assets/favicon.ico" />
</head>


<body>
    <div class="wrapper">
        <div class="navbar container">
    <a id="site-title" class="alignable pull-left" href="http://localhost:4000">mido</a>
    <ul id="navlist" class="alignable pull-right navbar-ul">
        
        <li class="alignable pull-left navbar-list">
            <a href="http://localhost:4000/about">About</a>
            /
        </li>
        
        <li class="alignable pull-left navbar-list">
            <a href="http://localhost:4000/resume.pdf">Resume</a>
            
        </li>
        
    </ul>
</div>
<div style="clear:both"></div>

<hr>

        <div class="page-title">
            Satori #2
        </div>
        <div class="container">
            <div class="content">
                <div class="page-subtitle">
    
        
            <b>[</b>
        
        <a href="/tags/#satori" title="satori">satori</a>
        
            -
        
    
        
        <a href="/tags/#ruby" title="ruby">ruby</a>
        
            <b>]</b>
        
    
</div>
<br>
<iframe width="50%" height="100" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/9636903"></iframe>

<p>Welcome back to <a href="http://vumanhcuongit.github.io/ruby/2014/10/08/satori-1/">Satori</a>! Today, I’d like to talk about <a href="http://www.ruby-doc.org/core-2.1.3/Array.html#method-i-map">map method</a>. You may know this method and it’s definition:</p>

<blockquote>
  <p>Invokes the given block once for each element of self. Creates a new array containing the values returned by the block.</p>
</blockquote>

<p>Last month, I got confused when seeing this case:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">my_confusion</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">=</span> <span class="no">Array</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">arr</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">element</span><span class="o">|</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">element</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">}</span>
<span class="k">end</span>
<span class="c1">#=&gt; [[2, 4, 6], [2, 4, 6], [2, 4, 6]]</span></code></pre></figure>

<p><strong>Misconception:</strong></p>

<p>Based on the above definition, I thought <code class="highlighter-rouge">my_confusion</code> returns <code class="highlighter-rouge">[[2], [2, 4], [2, 4, 6]]</code> but it doesn’t. So there is something wrong with <em>map method</em> ?</p>

<p><strong>Awakening:</strong></p>

<p><a href="http://www.ruby-doc.org/core-2.1.3/Array.html#method-i-3C-3C">Array#«</a>: this expression returns the <strong>array itself</strong>, so a result of this evaluation <code class="highlighter-rouge">result &lt;&lt; element * 2</code> is a reference that points to one and only one array in memory. Therefore, <em>map method</em> returns the array containing <strong>there references</strong> pointing to only one array. After running three loops, this array contains <code class="highlighter-rouge">[2, 4, 6]</code>.</p>

<p>Thanks Patrice and Stefan! You should see <a href="http://stackoverflow.com/questions/26201908/how-does-rubys-map-method-work-in-this-case?answertab=votes#tab-top">their great answers</a>.</p>

<p>That’s enough for my second Satori and thanks for your concern. If you have any questions, please don’t hesitate to discuss with me :).</p>


            </div>
            <div class="footer">
                <div class="footer">
    <br><hr>
    <a href="https://github.com/pro-panda" style="color: black">Theme by pro-panda</a>
</div>

            </div>
        </div>
    </div>
</body>
